<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style type="text/css">
canvas {
	border: 1px solid black;
}
</style>
<script type="text/javascript">

function Block(x,y,w,h,show,color)
{
	this.x =x;
	this.y= y;
	this.w =w;
	this.h = h;
	this.show = show;
	this.color = color;

}
//Block 클래스의 멤버함수 등록 : prototype 방식으로 처리
Block.prototype.call = function(){
	alert('call:' + this.color);
}

var block = new Block(0,0,1,2,true,"red");
block.call();

var block_array = new Array();


	var myfunc = {
		kor : function() {
			alert('안녕하세요');
		},
		eng : function() {
			alert('Hi! Everyone!!');
		}
	};

	var ball_x, ball_y, ball_radius;
	var ctx;
	var count = 5;
	var interval_timer, timer;
	var WIDTH;
	var HEIGHT;
	var bRight = true, bDown = true;
	var radgrad;
	window.onload = function init() {
		alert("load완료");

		var canvas = document.getElementById("my_canvas");
		WIDTH = canvas.width;
		HEIGHT = canvas.height;

		ball_x = WIDTH / 2;
		ball_y = HEIGHT / 2;
		ball_radius = 15;

		ctx = canvas.getContext("2d");
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, WIDTH, HEIGHT);
		draw_ball();
		//timer = setTimeout("process();",100); //회만 호출한다.
		
		init_block();
		
	};
	
	var block_w =100, block_h =30;
	
	function init_block(){
		var colors = [ "red" ,"green","blue","yellow","cyan","magenta","pink"];
		var index =0;
		for(var i =0;i<4;i++){
			var block_arr = new Array();//1차원배열
			for(var k=0;k<6;k++){
				var block = new Block(k*block_w,i*block_h,block_w,block_h,true,colors[index]);
				block_arr[k] = block;
				index ++;
				if(index>6)index =0;
			}
			block_array[i] = block_arr;
		}
	}
	
	
	
	window.onkeydown= function(e){
		console.log(e.keyCode);
	};
	
	
	
	function process() {
		//console.log("냠냠");
		/* 		count--;
		 if (count < 0)
		 clearInterval(interval_timer); */
		move_ball();
		check_block();
		draw();
	};
	 
	function check_block(){
		
		var wid = parseInt(ball_x/block_w);
		var hei = parseInt(ball_y/block_h);
		
		for(var i =0; i<block_array.length;i++){
			for(var k =0;k<block_array[i].length;k++){
				if(block_array[i][k].show==false)
					continue;
				
				if(i==wid&&k==hei){
					bDown = true;
					block_array[i][k].show =false;
				}
			}
		}
	}
	
	
	function move_ball() {
		if (bRight)
			ball_x += 5;
		else
			ball_x -= 5;

		if (bDown)
			ball_y += 5;
		else
			ball_y -= 5;

		if ((ball_x - ball_radius) < 0) {
			bRight = true;
		}
		if ((ball_x + ball_radius) > WIDTH) {
			bRight = false;
		}

		if ((ball_y - ball_radius) < 0) {
			bDown = true;
		}
		if ((ball_y + ball_radius) > HEIGHT) {
			bDown = false;
		}

	}
	function draw() {
		//ctx.clearRect(0,0,WIDTH,HEIGHT);
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, WIDTH, HEIGHT);
		draw_ball();
		draw_block();
	}
	function draw_block(){
		for(var i=0;i<block_array.length;i++){	
			for(var k =0;k<block_array[i].length;k++){
				var block = block_array[i][k];
				if(block.show == true){
					//블록그리기
					ctx.fillStyle = block.color;
					ctx.fillRect(block.x,block.y,block.w,block.h);
				}
			}
		}
	}
	function draw_ball() {
		radgrad = ctx.createRadialGradient(ball_x, ball_y, ball_radius* 1/ 10,
				ball_x - 5, ball_y - 5, ball_radius*7/10);
		radgrad.addColorStop(0, 'white');
		radgrad.addColorStop(1, 'red');
		ctx.fillStyle = radgrad;
		//ctx.fillStyle = "red";//그리기 (채우기)속성
		ctx.beginPath();
		ctx.arc(ball_x, ball_y, ball_radius, 0, Math.PI / 180 * 360, true);
		ctx.fill();
	};
	function start_stop(button) {
		if (interval_timer == null) {
			interval_timer = setInterval("process();", 1);
			button.value = "Stop";
		} else {
			button.value = "Start";
			clearInterval(interval_timer);
			interval_timer = null;
		}
	}
	function change_direction(button) {
		switch (button.value) {
		case "Left":
			bRight = false;
			break;
		case "Right":
			bRight = true;
			break;
		case "Up":
			bDown = false;
			break;
		case "Down":
			bDown = true;
			break;
		case "Plus":
			ball_radius += 5;
			break;
		case "Minus":
			ball_radius -= 5;
			break;
		}
	};
	
	

</script>
<title>Insert title here</title>
</head>
<body>

	<canvas id="my_canvas" width="600" height="400">
이 브라우저는 canvas가 지원하지 않습니다.</canvas>
	<hr>
	<input type="button" id="start_stop" value="Start"
		onclick="start_stop(this);">

	<input type="button" value="Left" onclick="change_direction(this);">
	<input type="button" value="Right" onclick="change_direction(this);">
	<input type="button" value="Up" onclick="change_direction(this);">
	<input type="button" value="Down" onclick="change_direction(this);">
	<input type="button" value="Plus" onclick="change_direction(this);">
	<input type="button" value="Minus" onclick="change_direction(this);">



</body>
</html>